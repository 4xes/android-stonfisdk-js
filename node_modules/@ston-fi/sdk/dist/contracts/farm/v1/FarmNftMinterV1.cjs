"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const w=require("tonweb"),A=require("../../../StonApiClient.cjs"),a=require("../../../utils/parseAddress.cjs"),k=require("../../../utils/parseBoolean.cjs"),S=require("../../../utils/createJettonTransferMessage.cjs"),d=require("../constants.cjs"),{boc:{Cell:m},utils:{Address:o,BN:n},token:{nft:{NftCollection:N},jetton:{JettonWallet:y}}}=w,r=class i extends N{constructor({tonApiClient:e,stonApiClient:t,...s}){super(e,s),this.stonApiClient=t??new A.StonApiClient(e),this.gasConstants={...i.gasConstants,...s.gasConstants}}async createStakeBody(){const e=new m;return e.bits.writeUint(d.FARM_OP_CODES.STAKE,32),e}async buildStakeTxParams(e){const[t,s,l]=await Promise.all([(async()=>new o(await this.stonApiClient.getJettonWalletAddress({jettonAddress:e.jettonAddress.toString(),ownerAddress:e.userWalletAddress.toString()})))(),this.createStakeBody(),this.getAddress()]),c=new n(e.forwardGasAmount??this.gasConstants.stakeForward),u=S.createJettonTransferMessage({queryId:e.queryId??0,amount:e.jettonAmount,destination:l,responseDestination:e.userWalletAddress,forwardTonAmount:c,forwardPayload:s}),g=new n(e.gasAmount??this.gasConstants.stake);return{to:new o(t.toString(!0,!0,!0)),payload:u,gasAmount:g}}async getData(){const e=await this.getAddress(),t=await this.provider.call2(e.toString(),"get_farming_minter_data");return{nextItemIndex:t[0],lastUpdateTime:t[1],status:t[2].toNumber(),depositedNanorewards:t[3],currentStakedTokens:t[4],accruedPerUnitNanorewards:t[5],accruedNanorewards:t[6],claimedNanorewards:t[7],contractUniqueId:t[8],nanorewardsPer24h:t[9],soulboundItems:k.parseBoolean(t[10]),minStakeTime:t[11],stakingTokenWallet:a.parseAddressNotNull(t[12]),rewardTokenWallet:a.parseAddressNotNull(t[13])}}async getStakingJettonAddress(){const{stakingTokenWallet:e}=await this.getData(),t=new y(this.provider,{address:e}),{jettonMinterAddress:s}=await t.getData();return s}};r.version=d.FARM_VERSION.v1;r.gasConstants={stake:new n("300000000"),stakeForward:new n("250000000")};let f=r;exports.FarmNftMinterV1=f;
//# sourceMappingURL=FarmNftMinterV1.cjs.map
